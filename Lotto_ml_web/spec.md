# 로또 ML 예측 웹 애플리케이션 - 기능 명세서 (Specification)

**Feature:** 001-lotto-ml-prediction  
**Branch:** 001-lotto-ml-prediction  
**작성일:** 2025-12-23  
**상태:** Draft

---

## 1. 개요 (Overview)

### 1.1 기능 설명
동행복권 API에서 역대 당첨번호(1회~1202회)를 수집하고, 머신러닝 기반 번호 예측 및 통계 분석을 제공하는 풀스택 웹 애플리케이션을 개발합니다.

### 1.2 비즈니스 가치
- 사용자들이 로또 통계 데이터를 직관적으로 확인
- ML 모델의 예측 결과를 비교/분석
- 다양한 전략 기반 번호 추천 제공

### 1.3 대상 사용자
| 사용자 유형 | 설명 |
|------------|------|
| 일반 사용자 | 로또 번호 추천 및 통계를 확인하고 싶은 일반인 |
| 데이터 분석가 | 로또 데이터의 통계적 패턴을 분석하려는 분석가 |
| ML/AI 학습자 | 실제 데이터로 머신러닝을 학습하고 싶은 개발자/학생 |

---

## 2. 사용자 스토리 (User Stories)

### US-001: 당첨번호 데이터 조회
**사용자로서,** 역대 로또 당첨번호를 회차별로 조회하여 패턴을 확인하고 싶다.

**인수 조건 (Acceptance Criteria):**
- [ ] 전체 당첨번호 목록 조회 (페이지네이션 지원)
- [ ] 특정 회차 번호로 검색 가능
- [ ] 날짜 범위로 필터링 가능
- [ ] 최신순/오래된순 정렬 가능
- [ ] 각 결과에 회차, 날짜, 6개 번호, 보너스 번호, 1등 당첨금 표시

### US-002: 통계 분석 대시보드
**사용자로서,** 번호별 출현 빈도와 패턴을 시각적으로 확인하고 싶다.

**인수 조건 (Acceptance Criteria):**
- [ ] 번호별 출현 빈도 히스토그램 (1-45번 각각)
- [ ] 홀짝 비율 분포 파이 차트
- [ ] 번호 합계 분포 히스토그램
- [ ] 연속번호 패턴 분석 차트
- [ ] 구간별 번호 분포 (1-15, 16-30, 31-45) 차트
- [ ] 최근 10회/50회/100회/전체 기간 필터 지원

### US-003: ML 기반 번호 예측
**사용자로서,** 다양한 ML 모델의 예측 번호를 비교하고 싶다.

**인수 조건 (Acceptance Criteria):**
- [ ] Random Forest 모델 예측 결과 표시
- [ ] Gradient Boosting 모델 예측 결과 표시
- [ ] Neural Network (MLP) 모델 예측 결과 표시
- [ ] 각 모델의 예측 정확도(±3 범위) 표시
- [ ] 예측 결과에 면책 문구 표시
- [ ] 마지막 학습 일시 표시

### US-004: 통계 기반 번호 추천
**사용자로서,** 다양한 전략 기반의 번호 추천을 받고 싶다.

**인수 조건 (Acceptance Criteria):**
- [ ] 고빈도 번호 기반 추천 (자주 나온 번호)
- [ ] 저빈도(오래 안 나온) 번호 기반 추천
- [ ] 홀짝 균형 조합 추천 (홀수 3개, 짝수 3개)
- [ ] 구간 분산 조합 추천 (각 구간 2개씩)
- [ ] 합계 범위(130-150) 기반 추천
- [ ] 각 추천 방식의 근거 설명 표시

### US-005: 데이터 동기화
**관리자로서,** 최신 당첨번호 데이터를 동기화하고 싶다.

**인수 조건 (Acceptance Criteria):**
- [ ] 증분 동기화 (새로운 회차만 추가)
- [ ] 전체 동기화 (1회~현재 회차 전체)
- [ ] 동기화 진행 상태 표시
- [ ] 동기화 완료/실패 알림

### US-006: ML 모델 학습
**관리자로서,** 새로운 데이터로 ML 모델을 재학습시키고 싶다.

**인수 조건 (Acceptance Criteria):**
- [ ] 학습 시작 버튼 클릭으로 모델 학습
- [ ] 학습 진행 상태 표시 (로딩 인디케이터)
- [ ] 학습 완료 시 각 모델의 정확도 표시
- [ ] 학습 완료/실패 알림

### US-007: 시스템 상태 확인
**사용자로서,** 서비스의 현재 상태를 확인하고 싶다.

**인수 조건 (Acceptance Criteria):**
- [ ] 현재 저장된 총 회차 수 표시
- [ ] 최신 회차 번호 표시
- [ ] ML 모델 학습 상태 (학습됨/미학습)
- [ ] 마지막 데이터 동기화 시간 표시

---

## 3. 기능 요구사항 (Functional Requirements)

### FR-001: 당첨번호 데이터 수집
| 항목 | 내용 |
|------|------|
| 데이터 소스 | 동행복권 API |
| API URL | `https://www.dhlottery.co.kr/common.do?method=getLottoNumber&drwNo={회차}` |
| 수집 범위 | 1회 ~ 1202회 (현재 기준) |
| 저장 데이터 | 회차, 날짜, 당첨번호 6개, 보너스번호, 1등 당첨금 |

### FR-002: 통계 분석
| 분석 유형 | 설명 |
|----------|------|
| 번호별 빈도 | 1-45번 각각의 출현 횟수 |
| 홀짝 비율 | 각 회차당 홀수/짝수 비율 분포 |
| 합계 분포 | 6개 번호 합계의 분포 |
| 연속번호 | 연속된 번호가 포함된 비율 |
| 구간 분포 | 저(1-15), 중(16-30), 고(31-45) 구간 분포 |

### FR-003: ML 예측 모델
| 모델 | 알고리즘 | 하이퍼파라미터 |
|------|----------|---------------|
| Model A | Random Forest | n_estimators=100, max_depth=10 |
| Model B | Gradient Boosting | n_estimators=50, max_depth=5 |
| Model C | Neural Network (MLP) | layers=(128,64,32), activation=ReLU |

### FR-004: 추천 전략
| 전략 | 설명 |
|------|------|
| 고빈도 | 출현 빈도가 높은 상위 번호 조합 |
| 저빈도 | 오랫동안 출현하지 않은 번호 조합 |
| 홀짝 균형 | 홀수 3개, 짝수 3개 |
| 구간 분산 | 각 구간(저/중/고)에서 2개씩 |
| 합계 최적 | 합계가 130-150 범위인 조합 |

---

## 4. 비기능 요구사항 (Non-Functional Requirements)

### NFR-001: 성능
| 지표 | 목표값 |
|------|--------|
| 페이지 로딩 | < 3초 |
| API 응답 (목록) | < 1초 |
| API 응답 (예측) | < 5초 |
| API 응답 (통계) | < 2초 |

### NFR-002: 확장성
- 동시 사용자 100+ 지원
- 데이터 증가에 따른 쿼리 성능 유지

### NFR-003: 호환성
- Chrome, Safari, Firefox, Edge 최신 버전 지원
- 반응형 디자인 (모바일/태블릿/데스크톱)

### NFR-004: 보안
- CORS 설정으로 허용된 도메인만 접근
- SQL Injection 방지 (파라미터화된 쿼리)
- 입력값 검증

---

## 5. UI/UX 요구사항

### 5.1 페이지 구성
```
/ (Home)
├── 대시보드 개요
├── 최근 당첨번호 요약
├── 빠른 예측 버튼
└── 시스템 상태

/results (당첨번호)
├── 당첨번호 테이블
├── 검색/필터 UI
└── 페이지네이션

/statistics (통계)
├── 번호별 빈도 차트
├── 홀짝 분포 차트
├── 합계 분포 차트
└── 구간별 분포 차트

/predict (예측)
├── ML 모델별 예측 결과
├── 모델 정확도 비교
└── 면책 문구

/recommend (추천)
├── 전략별 추천 번호
├── 추천 근거 설명
└── 새로고침 버튼

/admin (관리)
├── 데이터 동기화 버튼
├── 모델 학습 버튼
└── 시스템 상태 상세
```

### 5.2 디자인 가이드라인
- **색상 테마:** 로또 공식 색상 참고 (번호대별 색상)
  - 1-10: 노란색 (#FBC400)
  - 11-20: 파란색 (#69C8F2)
  - 21-30: 빨간색 (#FF7272)
  - 31-40: 회색 (#AAAAAA)
  - 41-45: 초록색 (#B0D840)
- **글꼴:** 시스템 기본 sans-serif
- **버튼:** Tailwind 기본 스타일 + hover 효과
- **차트:** Recharts 기본 스타일 활용

### 5.3 반응형 브레이크포인트
- Mobile: < 640px
- Tablet: 640px ~ 1024px
- Desktop: > 1024px

---

## 6. 데이터 모델

### 6.1 lotto_results 테이블
```sql
CREATE TABLE lotto_results (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    draw_no INTEGER UNIQUE NOT NULL,      -- 회차 번호
    draw_date TEXT NOT NULL,              -- 추첨 날짜 (YYYY-MM-DD)
    num1 INTEGER NOT NULL,                -- 당첨번호 1
    num2 INTEGER NOT NULL,                -- 당첨번호 2
    num3 INTEGER NOT NULL,                -- 당첨번호 3
    num4 INTEGER NOT NULL,                -- 당첨번호 4
    num5 INTEGER NOT NULL,                -- 당첨번호 5
    num6 INTEGER NOT NULL,                -- 당첨번호 6
    bonus INTEGER NOT NULL,               -- 보너스 번호
    prize_1st INTEGER,                    -- 1등 당첨금
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 6.2 ML 모델 파일
```
models/
├── scaler.pkl           -- StandardScaler
├── random_forest.pkl    -- Random Forest 모델
├── gradient_boosting.pkl -- Gradient Boosting 모델
└── neural_network.pkl   -- MLP 모델
```

---

## 7. API 명세

### 7.1 엔드포인트 목록
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api/v1/results` | 당첨번호 목록 조회 |
| GET | `/api/v1/results/{draw_no}` | 특정 회차 조회 |
| GET | `/api/v1/statistics` | 전체 통계 조회 |
| POST | `/api/v1/sync` | 증분 데이터 동기화 |
| POST | `/api/v1/sync/full` | 전체 데이터 동기화 |
| POST | `/api/v1/train` | ML 모델 학습 |
| GET | `/api/v1/predict` | ML 모델 예측 |
| GET | `/api/v1/recommend` | 통계 기반 추천 |
| GET | `/api/v1/status` | 시스템 상태 |

### 7.2 응답 형식 예시

#### 성공 응답
```json
{
  "status": "success",
  "data": {
    "draw_no": 1202,
    "draw_date": "2025-12-20",
    "numbers": [3, 12, 18, 24, 35, 41],
    "bonus": 7,
    "prize_1st": 2543000000
  },
  "message": null
}
```

#### 에러 응답
```json
{
  "detail": "회차 번호를 찾을 수 없습니다."
}
```

---

## 8. 성공 기준 (Success Criteria)

### 8.1 기능 완성도
- [ ] 모든 User Story 인수 조건 충족
- [ ] 모든 API 엔드포인트 정상 작동
- [ ] 3개 ML 모델 학습 및 예측 가능

### 8.2 품질 지표
- [ ] 페이지 로딩 3초 이내
- [ ] API 응답 5초 이내
- [ ] 주요 브라우저 호환성 확인
- [ ] 반응형 UI 동작 확인

### 8.3 테스트
- [ ] API 엔드포인트 테스트 100% 통과
- [ ] 데이터 수집 정상 동작
- [ ] ML 모델 학습/예측 정상 동작

---

## 9. 제약사항 및 가정

### 9.1 제약사항
- 동행복권 API가 가용해야 함
- API 호출 속도 제한 준수 필요
- SQLite 파일 크기 제한 (대용량 데이터시 PostgreSQL 전환)

### 9.2 가정
- 사용자는 현대적 브라우저를 사용
- 서버는 인터넷 연결 상태
- Python 3.11+ 실행 환경 제공

---

## 10. 용어 정의 (Glossary)

| 용어 | 정의 |
|------|------|
| 회차 (draw_no) | 로또 추첨 회차 번호 |
| 보너스 번호 | 2등 당첨 판정용 추가 번호 |
| 고빈도 번호 | 역대 출현 횟수가 많은 번호 |
| 저빈도 번호 | 최근 출현하지 않은 번호 |
| ±3 정확도 | 예측값이 실제값 ±3 범위 내 적중률 |

---

**문서 끝**
